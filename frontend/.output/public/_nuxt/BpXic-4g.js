import{_ as O}from"./9ykhWItT.js";import{d as L,r as B,e as j,c,o as u,f as e,z as P,g as I,t as v,F as G,k as D,L as C,h as x,Q as N,i as M,I as Q,A as J,x as K,u as W,a as $,w as R,s as z,_ as X,n as H,R as A}from"./BE3ND16f.js";import{_ as Y}from"./CW04_7D2.js";const Z={class:"markdown-editor"},F={class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"},ee={key:0,class:"text-red-500"},te={class:"border border-gray-300 dark:border-gray-600 rounded-t-lg bg-gray-50 dark:bg-gray-700 p-2 flex flex-wrap gap-1"},re=["onClick","title"],ae=["value","rows","placeholder"],oe={key:0,class:"text-red-500 text-sm mt-1"},ne=L({__name:"MarkdownEditor",props:{modelValue:{},label:{default:"Contenido"},placeholder:{default:"Escribe tu contenido aqu√≠..."},rows:{default:15},required:{type:Boolean,default:!1},error:{default:""}},emits:["update:modelValue"],setup(V,{emit:f}){const s=V,h=f,p=B(),m=j(()=>s.error?"border-red-500":""),S=[{name:"bold",icon:"ùêÅ",title:"Negrita",before:"**",after:"**"},{name:"italic",icon:"ùêº",title:"Cursiva",before:"*",after:"*"},{name:"heading1",icon:"H1",title:"T√≠tulo 1",before:"# "},{name:"heading2",icon:"H2",title:"T√≠tulo 2",before:"## "},{name:"heading3",icon:"H3",title:"T√≠tulo 3",before:"### "},{name:"link",icon:"üîó",title:"Enlace",before:"[texto](",after:")"},{name:"image",icon:"üñºÔ∏è",title:"Imagen",before:"![alt](",after:")"},{name:"code",icon:"</>",title:"C√≥digo",before:"`",after:"`"},{name:"codeblock",icon:"{ }",title:"Bloque de c√≥digo",before:"```\n",after:"\n```"},{name:"quote",icon:"‚ùù",title:"Cita",before:"> "},{name:"list",icon:"‚Ä¢",title:"Lista",before:"- "},{name:"numberedlist",icon:"1.",title:"Lista numerada",before:"1. "},{name:"hr",icon:"‚Äî",title:"L√≠nea horizontal",before:`
---
`}],T=(n,g="")=>{const o=p.value;if(!o)return;const i=o.selectionStart,_=o.selectionEnd,r=s.modelValue.substring(i,_);let t;if(g)t=s.modelValue.substring(0,i)+n+r+g+s.modelValue.substring(_),N(()=>{o.focus(),o.setSelectionRange(i+n.length,i+n.length+r.length)});else{const l=s.modelValue.split(`
`),k=s.modelValue.substring(0,i).split(`
`).length-1,E=s.modelValue.substring(0,_).split(`
`).length-1;for(let d=k;d<=E;d++)l[d]!==void 0&&(l[d]=n+l[d]);t=l.join(`
`),N(()=>{o.focus();const d=i+n.length;o.setSelectionRange(d,d)})}h("update:modelValue",t)};return(n,g)=>(u(),c("div",Z,[e("label",F,[I(v(n.label)+" ",1),n.required?(u(),c("span",ee,"*")):P("",!0)]),e("div",te,[(u(),c(G,null,D(S,o=>e("button",{key:o.name,type:"button",onClick:i=>T(o.before,o.after),class:"px-2 py-1 text-xs bg-white dark:bg-gray-600 border border-gray-300 dark:border-gray-500 rounded hover:bg-gray-100 dark:hover:bg-gray-500 transition-colors",title:o.title},v(o.icon),9,re)),64))]),e("textarea",{ref_key:"textareaRef",ref:p,value:n.modelValue,onInput:g[0]||(g[0]=o=>n.$emit("update:modelValue",o.target.value)),rows:n.rows,class:C(["w-full px-3 py-2 border-l border-r border-b border-gray-300 dark:border-gray-600 rounded-b-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",x(m)]),placeholder:n.placeholder},null,42,ae),n.error?(u(),c("p",oe,v(n.error),1)):P("",!0),g[1]||(g[1]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-2"},[I(" Puedes usar Markdown para formatear el contenido. "),e("a",{href:"https://www.markdownguide.org/basic-syntax/",target:"_blank",class:"text-primary-600 hover:text-primary-700"}," Gu√≠a de Markdown ")],-1))]))}}),se=M(ne,[["__scopeId","data-v-394d36f2"]]),le={class:"markdown-preview"},ie=["innerHTML"],de=L({__name:"MarkdownPreview",props:{content:{}},setup(V){const f=V,s=j(()=>f.content?f.content.replace(/^### (.*$)/gim,"<h3>$1</h3>").replace(/^## (.*$)/gim,"<h2>$1</h2>").replace(/^# (.*$)/gim,"<h1>$1</h1>").replace(/\*\*(.*)\*\*/gim,"<strong>$1</strong>").replace(/\*(.*)\*/gim,"<em>$1</em>").replace(/`(.*?)`/gim,"<code>$1</code>").replace(/\[([^\]]+)\]\(([^)]+)\)/gim,'<a href="$2" target="_blank" rel="noopener">$1</a>').replace(/!\[([^\]]*)\]\(([^)]+)\)/gim,'<img src="$2" alt="$1" class="max-w-full h-auto" />').replace(/\n/gim,"<br>").replace(/^> (.*$)/gim,"<blockquote>$1</blockquote>").replace(/^\- (.*$)/gim,"<li>$1</li>").replace(/^(\d+)\. (.*$)/gim,"<li>$2</li>").replace(/^---$/gim,"<hr>"):'<p class="text-gray-500 italic">Vista previa aparecer√° aqu√≠...</p>');return(h,p)=>(u(),c("div",le,[e("div",{class:"prose prose-sm max-w-none dark:prose-invert",innerHTML:x(s)},null,8,ie)]))}}),ce=M(de,[["__scopeId","data-v-e95d9f2b"]]),ue={class:"max-w-4xl mx-auto space-y-6"},ge={class:"flex items-center justify-between"},pe={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},me={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},be={class:"lg:col-span-2 space-y-6"},xe=["value","onInput"],fe={key:0,class:"text-red-500 text-sm mt-1"},he={class:"flex items-center justify-between mb-2"},ye={class:"flex bg-gray-100 dark:bg-gray-700 rounded-lg p-1"},ve={class:"min-h-[400px]"},_e=["value","onInput"],ke={class:"space-y-6"},we=["value","onChange"],$e=["value"],Ce={key:0,class:"text-red-500 text-sm mt-1"},Ve=["value","onChange"],Pe={class:"flex items-center"},Ie=["checked","onChange"],Se=L({__name:"create",setup(V){const{handleSuccess:f,handleError:s}=Q(),h=J(),p=B([]),m=B("editor"),S={title:"",content:"",excerpt:"",status:"draft",category:"",featured:!1},T={title:r=>!r||r.trim().length<5?"El t√≠tulo debe tener al menos 5 caracteres":null,content:r=>!r||r.trim().length<20?"El contenido debe tener al menos 20 caracteres":null,category:r=>r?null:"Debes seleccionar una categor√≠a"},n=async r=>{await i(r,"published")},g=async r=>{await i(r,"draft")},o=()=>{h.push("/admin/posts")},i=async(r,t)=>{try{const{token:l}=z();if(!l.value){s("No se encontr√≥ token de autenticaci√≥n. Por favor, inicia sesi√≥n nuevamente.","submitPost");return}const k={titulo:r.title,contenido:r.content,status:t,featured:r.featured,categoria:r.category,meta_title:r.title,meta_description:r.excerpt};await $fetch("/api/v1/dashboard/api/posts/",{method:"POST",body:k,headers:{Authorization:`Bearer ${l.value}`}}),f(`Post ${t==="published"?"publicado":"guardado como borrador"} exitosamente`),h.push("/admin/posts")}catch(l){throw s(l,"submitPost"),l}},_=async()=>{try{const{token:r}=z();if(!r.value){console.error("No auth token available for fetching categories");return}const t=await $fetch("/api/v1/dashboard/api/categories/",{headers:{Authorization:`Bearer ${r.value}`}});p.value=t.results||t}catch(r){console.error("Error fetching categories:",r);try{const t=await $fetch("/api/v1/categories/");p.value=t.results||t}catch(t){console.error("Error fetching categories from fallback:",t),p.value=[{id:1,name:"General",slug:"general"},{id:2,name:"Noticias",slug:"noticias"}]}}};return K(()=>{_()}),W({title:"Crear Post - Administraci√≥n",meta:[{name:"description",content:"Crear nuevo post para el blog"}]}),(r,t)=>{const l=O,k=X,E=se,d=ce,U=Y;return u(),c("div",ue,[e("div",ge,[t[3]||(t[3]=e("div",null,[e("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white"}," Crear Nuevo Post "),e("p",{class:"text-gray-600 dark:text-gray-400"}," Crea un nuevo art√≠culo para el blog ")],-1)),$(k,{to:"/admin/posts",class:"btn btn-secondary"},{default:R(()=>[$(l,{name:"arrow-left",class:"w-4 h-4 mr-2"}),t[2]||(t[2]=I(" Volver ",-1))]),_:1,__:[2]})]),e("div",pe,[$(U,{"initial-data":S,"validation-rules":T,"submit-text":"Publicar Post","draft-text":"Guardar Borrador","show-draft":!0,"is-draftable":!0,onSubmit:n,onDraft:g,onCancel:o},{default:R(({form:b,setField:y,getError:q,hasError:w})=>[e("div",me,[e("div",be,[e("div",null,[t[4]||(t[4]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," T√≠tulo * ",-1)),e("input",{value:b.title,onInput:a=>y("title",a.target.value),type:"text",class:C(["input w-full",{"border-red-500":w("title")}]),placeholder:"Ingresa el t√≠tulo del post"},null,42,xe),w("title")?(u(),c("p",fe,v(q("title")),1)):P("",!0)]),e("div",null,[e("div",he,[t[5]||(t[5]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300"},[I(" Contenido "),e("span",{class:"text-red-500"},"*")],-1)),e("div",ye,[e("button",{type:"button",onClick:t[0]||(t[0]=a=>m.value="editor"),class:C(["px-3 py-1 text-sm rounded-md transition-colors",x(m)==="editor"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])}," Editor ",2),e("button",{type:"button",onClick:t[1]||(t[1]=a=>m.value="preview"),class:C(["px-3 py-1 text-sm rounded-md transition-colors",x(m)==="preview"?"bg-white dark:bg-gray-600 text-gray-900 dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white"])}," Vista Previa ",2)])]),H(e("div",null,[$(E,{"model-value":b.content,"onUpdate:modelValue":a=>y("content",a),label:"",required:!0,error:w("content")?q("content"):"",placeholder:"Escribe el contenido del post...",rows:15},null,8,["model-value","onUpdate:modelValue","error"])],512),[[A,x(m)==="editor"]]),H(e("div",ve,[$(d,{content:b.content},null,8,["content"])],512),[[A,x(m)==="preview"]])]),e("div",null,[t[6]||(t[6]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Extracto ",-1)),e("textarea",{value:b.excerpt,onInput:a=>y("excerpt",a.target.value),rows:"3",class:"w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-transparent bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",placeholder:"Breve descripci√≥n del post (opcional)"},null,40,_e),t[7]||(t[7]=e("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," Resumen que aparecer√° en las listas de posts ",-1))])]),e("div",ke,[e("div",null,[t[9]||(t[9]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Categor√≠a * ",-1)),e("select",{value:b.category,onChange:a=>y("category",a.target.value),class:C(["input w-full",{"border-red-500":w("category")}])},[t[8]||(t[8]=e("option",{value:""},"Seleccionar categor√≠a",-1)),(u(!0),c(G,null,D(x(p),a=>(u(),c("option",{key:a.id,value:a.id},v(a.name||a.nombre),9,$e))),128))],42,we),w("category")?(u(),c("p",Ce,v(q("category")),1)):P("",!0)]),e("div",null,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Estado ",-1)),e("select",{value:b.status,onChange:a=>y("status",a.target.value),class:"input w-full"},t[10]||(t[10]=[e("option",{value:"draft"},"Borrador",-1),e("option",{value:"published"},"Publicado",-1),e("option",{value:"archived"},"Archivado",-1)]),40,Ve)]),e("div",null,[e("label",Pe,[e("input",{checked:b.featured,onChange:a=>y("featured",a.target.checked),type:"checkbox",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,40,Ie),t[12]||(t[12]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Post destacado ",-1))])])])])]),_:1})])])}}}),Be=M(Se,[["__scopeId","data-v-e7753dc7"]]);export{Be as default};
