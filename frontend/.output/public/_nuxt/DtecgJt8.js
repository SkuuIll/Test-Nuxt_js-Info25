import{_ as I}from"./CuvBqip4.js";import{_ as T}from"./9ykhWItT.js";import{d as z,s as F,I as G,r as h,E as P,e as H,J as $,u as J,c as C,a as f,f as t,m as V,n as l,v as i,h as s,l as N,z as y,g as b,t as g,w as K,D as O,_ as Q,o as x}from"./BE3ND16f.js";const R={class:"container mx-auto px-4 py-8"},W={class:"max-w-4xl mx-auto"},X={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Y={class:"lg:col-span-2"},Z={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},tt={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},et={class:"mt-6 flex justify-end"},st=["disabled"],at={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mt-6"},rt={class:"space-y-4"},ot={class:"mt-6 flex justify-end"},nt=["disabled"],lt={class:"lg:col-span-1"},it={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},dt={class:"space-y-4"},mt={class:"flex items-center justify-between"},ut={class:"text-sm font-medium text-gray-900 dark:text-white"},pt={class:"flex items-center justify-between"},ct={class:"text-sm font-medium text-gray-900 dark:text-white"},ft={key:0,class:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700"},bt={class:"mt-4"},_t=z({__name:"profile",setup(gt){const{user:u,updateProfile:E,changePassword:S,logout:j}=F(),{handleSuccess:w,handleError:p}=G(),d=h(!1),m=h(!1),r=P({username:"",email:"",first_name:"",last_name:""}),a=P({current_password:"",new_password:"",confirm_password:""}),A=H(()=>a.current_password&&a.new_password&&a.confirm_password&&a.new_password===a.confirm_password&&a.new_password.length>=8),B=async()=>{try{d.value=!0,await E({email:r.email,first_name:r.first_name,last_name:r.last_name}),w("Perfil actualizado correctamente")}catch(o){p(o,"updateProfile")}finally{d.value=!1}},D=async()=>{if(a.new_password!==a.confirm_password){p("Las contraseñas no coinciden");return}try{m.value=!0,await S(a.current_password,a.new_password),a.current_password="",a.new_password="",a.confirm_password="",w("Contraseña cambiada correctamente")}catch(o){p(o,"changePassword")}finally{m.value=!1}},L=async()=>{try{await j(),w("Sesión cerrada correctamente"),await O("/")}catch(o){p(o,"logout")}},U=o=>o?new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric"}):"N/A";return $(u,o=>{o&&(r.username=o.username,r.email=o.email,r.first_name=o.first_name||"",r.last_name=o.last_name||"")},{immediate:!0}),J({title:"Mi Perfil - Blog de Noticias",meta:[{name:"description",content:"Gestiona tu perfil de usuario, actualiza tu información personal y cambia tu contraseña."},{name:"robots",content:"noindex, nofollow"}]}),(o,e)=>{var _,k,v;const M=I,c=T,q=Q;return x(),C("div",R,[f(M,{items:[{name:"Perfil"}]}),t("div",W,[e[23]||(e[23]=t("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-8"},"Mi Perfil",-1)),t("div",X,[t("div",Y,[t("div",Z,[e[12]||(e[12]=t("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-6"}," Información Personal ",-1)),t("form",{onSubmit:V(B,["prevent"])},[t("div",tt,[t("div",null,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Nombre de usuario ",-1)),l(t("input",{"onUpdate:modelValue":e[0]||(e[0]=n=>s(r).username=n),type:"text",class:"input w-full",readonly:"",disabled:""},null,512),[[i,s(r).username]]),e[8]||(e[8]=t("p",{class:"text-xs text-gray-500 mt-1"},"El nombre de usuario no se puede cambiar",-1))]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Email ",-1)),l(t("input",{"onUpdate:modelValue":e[1]||(e[1]=n=>s(r).email=n),type:"email",class:"input w-full",required:""},null,512),[[i,s(r).email]])]),t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Nombre ",-1)),l(t("input",{"onUpdate:modelValue":e[2]||(e[2]=n=>s(r).first_name=n),type:"text",class:"input w-full"},null,512),[[i,s(r).first_name]])]),t("div",null,[e[11]||(e[11]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Apellido ",-1)),l(t("input",{"onUpdate:modelValue":e[3]||(e[3]=n=>s(r).last_name=n),type:"text",class:"input w-full"},null,512),[[i,s(r).last_name]])])]),t("div",et,[t("button",{type:"submit",disabled:s(d),class:"btn btn-primary"},[s(d)?(x(),N(c,{key:0,name:"loading",class:"w-4 h-4 animate-spin mr-2"})):y("",!0),b(" "+g(s(d)?"Guardando...":"Guardar Cambios"),1)],8,st)])],32)]),t("div",at,[e[16]||(e[16]=t("h2",{class:"text-xl font-semibold text-gray-900 dark:text-white mb-6"}," Cambiar Contraseña ",-1)),t("form",{onSubmit:V(D,["prevent"])},[t("div",rt,[t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Contraseña actual ",-1)),l(t("input",{"onUpdate:modelValue":e[4]||(e[4]=n=>s(a).current_password=n),type:"password",class:"input w-full",required:""},null,512),[[i,s(a).current_password]])]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Nueva contraseña ",-1)),l(t("input",{"onUpdate:modelValue":e[5]||(e[5]=n=>s(a).new_password=n),type:"password",class:"input w-full",required:""},null,512),[[i,s(a).new_password]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Confirmar nueva contraseña ",-1)),l(t("input",{"onUpdate:modelValue":e[6]||(e[6]=n=>s(a).confirm_password=n),type:"password",class:"input w-full",required:""},null,512),[[i,s(a).confirm_password]])])]),t("div",ot,[t("button",{type:"submit",disabled:s(m)||!s(A),class:"btn btn-primary"},[s(m)?(x(),N(c,{key:0,name:"loading",class:"w-4 h-4 animate-spin mr-2"})):y("",!0),b(" "+g(s(m)?"Cambiando...":"Cambiar Contraseña"),1)],8,nt)])],32)])]),t("div",lt,[t("div",it,[e[22]||(e[22]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Información de la cuenta ",-1)),t("div",dt,[e[19]||(e[19]=t("div",{class:"flex items-center justify-between"},[t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Estado:"),t("span",{class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}," Activo ")],-1)),t("div",mt,[e[17]||(e[17]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Tipo:",-1)),t("span",ut,g((_=s(u))!=null&&_.is_staff?"Administrador":"Usuario"),1)]),t("div",pt,[e[18]||(e[18]=t("span",{class:"text-sm text-gray-600 dark:text-gray-400"},"Miembro desde:",-1)),t("span",ct,g(U((k=s(u))==null?void 0:k.date_joined)),1)])]),(v=s(u))!=null&&v.is_staff?(x(),C("div",ft,[f(q,{to:"/admin",class:"btn btn-secondary w-full"},{default:K(()=>[f(c,{name:"settings",class:"w-4 h-4 mr-2"}),e[20]||(e[20]=b(" Panel de Administración ",-1))]),_:1,__:[20]})])):y("",!0),t("div",bt,[t("button",{class:"btn btn-ghost w-full text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20",onClick:L},[f(c,{name:"logout",class:"w-4 h-4 mr-2"}),e[21]||(e[21]=b(" Cerrar Sesión ",-1))])])])])])])])}}});export{_t as default};
