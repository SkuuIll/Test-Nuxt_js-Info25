import{_ as E}from"./CuvBqip4.js";import{_ as I}from"./9ykhWItT.js";import{_ as $}from"./DX5PA3XH.js";import{_ as O}from"./CW8f94Lj.js";import{d as R,B as U,r as _,E as j,e as v,x as z,u as H,c as l,a as w,f as e,z as c,m as Y,n as x,v as Z,h as o,p as C,l as D,g as N,H as h,F as S,k as q,b as L,t as b,o as r,D as Q}from"./BE3ND16f.js";import{u as G}from"./DJaA1xmL.js";import"./D0J4bnbB.js";import"./D_M7RfL4.js";const J={class:"container mx-auto px-4 py-8"},K={class:"max-w-4xl mx-auto"},W={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6 mb-8"},X={class:"flex gap-4 mb-4"},tt={class:"flex-1"},et=["disabled"],ot={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},st=["value"],at={key:0},rt={class:"flex items-center justify-between mb-6"},nt={class:"text-xl font-semibold text-gray-900 dark:text-white"},lt={key:0,class:"text-gray-600 dark:text-gray-400 font-normal"},it={class:"text-sm text-gray-600 dark:text-gray-400"},ut={key:0,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},dt={key:1,class:"text-center py-12"},ct={key:2,class:"mt-8 flex justify-center"},mt={key:1,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},wt=R({__name:"search",setup(gt){const u=G(),m=U(),a=_(m.query.q||""),f=_(!1),g=_(""),n=j({category:m.query.category||"",ordering:m.query.ordering||"-published_at"}),B=v(()=>u.posts),V=v(()=>u.categories),p=v(()=>u.loading),d=v(()=>u.pagination),A=async()=>{a.value.trim()&&(f.value=!0,await Q({path:"/search",query:{q:a.value,...n}}),await u.searchPosts({query:a.value,...n}))},M=()=>{const i=new Date;switch(g.value){case"today":n.date_from=i.toISOString().split("T")[0];break;case"week":const t=new Date(i.getTime()-10080*60*1e3);n.date_from=t.toISOString().split("T")[0];break;case"month":const k=new Date(i.getFullYear(),i.getMonth()-1,i.getDate());n.date_from=k.toISOString().split("T")[0];break;case"year":const y=new Date(i.getFullYear()-1,i.getMonth(),i.getDate());n.date_from=y.toISOString().split("T")[0];break;default:delete n.date_from}},T=async i=>{await u.searchPosts({query:a.value,...n,page:i})};return z(async()=>{await u.fetchCategories(),m.query.q&&(f.value=!0,await u.searchPosts({query:a.value,...n}))}),H({title:a.value?`Búsqueda: ${a.value} - Blog de Noticias`:"Buscar Artículos - Blog de Noticias",meta:[{name:"description",content:a.value?`Resultados de búsqueda para "${a.value}" en nuestro blog de noticias.`:"Busca artículos y noticias en nuestro blog. Encuentra contenido relevante y actualizado."},{name:"robots",content:a.value?"noindex, follow":"index, follow"}]}),(i,t)=>{const k=E,y=I,F=$,P=O;return r(),l("div",J,[w(k,{items:[{name:"Búsqueda"}]}),e("div",K,[t[16]||(t[16]=e("h1",{class:"text-3xl font-bold text-gray-900 dark:text-white mb-8"}," Buscar Artículos ",-1)),e("div",W,[e("form",{onSubmit:Y(A,["prevent"])},[e("div",X,[e("div",tt,[x(e("input",{"onUpdate:modelValue":t[0]||(t[0]=s=>C(a)?a.value=s:null),type:"text",placeholder:"Buscar artículos...",class:"input w-full",autofocus:""},null,512),[[Z,o(a)]])]),e("button",{type:"submit",disabled:!o(a).trim()||o(p),class:"btn btn-primary px-6"},[o(p)?(r(),D(y,{key:0,name:"loading",class:"w-4 h-4 animate-spin mr-2"})):c("",!0),t[6]||(t[6]=N(" Buscar ",-1))],8,et)]),e("div",ot,[e("div",null,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Categoría ",-1)),x(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>o(n).category=s),class:"input w-full"},[t[7]||(t[7]=e("option",{value:""}," Todas las categorías ",-1)),(r(!0),l(S,null,q(o(V),s=>(r(),l("option",{key:s.id,value:s.slug},b(s.name),9,st))),128))],512),[[h,o(n).category]])]),e("div",null,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Ordenar por ",-1)),x(e("select",{"onUpdate:modelValue":t[2]||(t[2]=s=>o(n).ordering=s),class:"input w-full"},t[9]||(t[9]=[e("option",{value:"-published_at"}," Más recientes ",-1),e("option",{value:"published_at"}," Más antiguos ",-1),e("option",{value:"title"}," Título A-Z ",-1),e("option",{value:"-title"}," Título Z-A ",-1)]),512),[[h,o(n).ordering]])]),e("div",null,[t[12]||(t[12]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Fecha ",-1)),x(e("select",{"onUpdate:modelValue":t[3]||(t[3]=s=>C(g)?g.value=s:null),class:"input w-full",onChange:M},t[11]||(t[11]=[L('<option value=""> Cualquier fecha </option><option value="today"> Hoy </option><option value="week"> Esta semana </option><option value="month"> Este mes </option><option value="year"> Este año </option>',5)]),544),[[h,o(g)]])])])],32)]),o(f)?(r(),l("div",at,[e("div",rt,[e("h2",nt,[t[13]||(t[13]=N(" Resultados de búsqueda ",-1)),o(a)?(r(),l("span",lt,' para "'+b(o(a))+'" ',1)):c("",!0)]),e("p",it,b(o(d).total)+" resultado"+b(o(d).total!==1?"s":""),1)]),o(B).length>0?(r(),l("div",ut,[(r(!0),l(S,null,q(o(B),s=>(r(),D(F,{key:s.id,post:s,"show-excerpt":!0,"show-category":!0,"show-author":!0,"show-date":!0},null,8,["post"]))),128))])):o(p)?c("",!0):(r(),l("div",dt,[w(y,{name:"search",class:"w-16 h-16 mx-auto text-gray-400 dark:text-gray-600 mb-4"}),t[14]||(t[14]=e("h3",{class:"text-lg font-medium text-gray-900 dark:text-white mb-2"}," No se encontraron resultados ",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 dark:text-gray-400"}," Intenta con otros términos de búsqueda o ajusta los filtros. ",-1))])),o(d).total>o(d).pageSize?(r(),l("div",ct,[o(d).hasPrevious?(r(),l("button",{key:0,class:"btn btn-secondary mr-2",onClick:t[4]||(t[4]=s=>T(o(d).page-1))}," Anterior ")):c("",!0),o(d).hasNext?(r(),l("button",{key:1,class:"btn btn-secondary",onClick:t[5]||(t[5]=s=>T(o(d).page+1))}," Siguiente ")):c("",!0)])):c("",!0)])):c("",!0),o(p)?(r(),l("div",mt,[(r(),l(S,null,q(6,s=>w(P,{key:s})),64))])):c("",!0)])])}}});export{wt as default};
