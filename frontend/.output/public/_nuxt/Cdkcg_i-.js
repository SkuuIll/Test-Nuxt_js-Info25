import{_ as z}from"./9ykhWItT.js";import{d as H,B as q,s as O,j as K,r as m,M as Y,x as G,c as l,z as y,h as s,b as J,f as t,a as d,t as n,w as f,F as N,k as $,L as Q,m as W,n as X,v as Z,p as tt,q as E,K as et,_ as st,o as i,g as b,l as at,u as ot,i as rt}from"./BE3ND16f.js";import{_ as nt,u as it,a as lt}from"./D0J4bnbB.js";import"./D_M7RfL4.js";const ct={key:0,class:"container mx-auto px-4 py-8"},dt={key:1,class:"container mx-auto px-4 py-8"},ut={class:"text-center py-12"},mt={class:"text-gray-600 dark:text-gray-400 mb-4"},pt={key:2,class:"container mx-auto px-4 py-8"},gt={class:"max-w-4xl mx-auto"},ht={class:"mb-8"},xt={class:"mb-4"},_t={class:"text-4xl md:text-5xl font-bold text-gray-900 dark:text-white mb-6 leading-tight"},vt={class:"flex flex-col md:flex-row md:items-center md:justify-between text-gray-600 dark:text-gray-400 mb-6"},yt={class:"flex items-center space-x-6 mb-4 md:mb-0"},ft={class:"flex items-center space-x-2"},bt={class:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white font-medium"},wt={class:"font-medium text-gray-900 dark:text-white"},kt={class:"flex items-center space-x-1"},Ct=["datetime"],Et={class:"flex items-center space-x-1"},It={class:"flex items-center space-x-2"},Mt={key:0,class:"mb-8"},Lt={class:"prose prose-lg dark:prose-invert max-w-none mb-12"},Tt=["innerHTML"],Nt={key:0,class:"mb-8"},$t={class:"flex flex-wrap gap-2"},jt={class:"flex items-center justify-between py-6 border-t border-b border-gray-200 dark:border-gray-700 mb-8"},At={class:"flex items-center space-x-4"},St={class:"text-sm text-gray-500 dark:text-gray-400"},Ut={class:"mb-12"},Vt={class:"text-2xl font-bold text-gray-900 dark:text-white mb-6"},Bt={key:0,class:"mb-8"},Dt={class:"flex justify-end"},Ft=["disabled"],Pt={key:0},Rt={key:1},zt={key:1,class:"mb-8 p-6 bg-gray-50 dark:bg-gray-800 rounded-lg text-center"},Ht={class:"space-y-6"},qt={class:"flex items-start space-x-4"},Ot={class:"w-10 h-10 bg-primary-600 rounded-full flex items-center justify-center text-white font-medium flex-shrink-0"},Kt={class:"flex-1"},Yt={class:"flex items-center space-x-2 mb-2"},Gt={class:"font-medium text-gray-900 dark:text-white"},Jt=["datetime"],Qt={class:"text-gray-700 dark:text-gray-300"},Wt={key:2,class:"text-center mt-6"},Xt=H({__name:"[slug]",setup(Zt){const w=q(),{isAuthenticated:j}=O(),{$toast:g}=K(),{getImageUrl:I,getPlaceholderUrl:A}=lt(),{getAuthorInitials:M,getAuthorDisplayName:L}=it(),e=m(null),h=m([]),k=m(!0),_=m(null),p=m(""),v=m(!1),x=m(!1),C=m(!1),S=async()=>{try{k.value=!0,_.value=null;const o=E(),a=w.params.slug;if(console.log("🔍 Fetching post with slug:",a),console.log("📍 Route params:",w.params),console.log("🛣️ Full route path:",w.fullPath),!a||a==="undefined"||a==="null")throw console.error("❌ Invalid slug detected:",a),new Error("Slug de post inválido");const r=await o.getPost(a);e.value=r.data||r;const u=await o.getComments({post:e.value.id});h.value=u.results||u.data||[],C.value=!!u.next}catch(o){if(console.error("❌ Error fetching post:",o),_.value=o.message||"Post no encontrado",o.status===404||o.statusCode===404)throw et({statusCode:404,statusMessage:"Post no encontrado"})}finally{k.value=!1}},U=async()=>{if(!(!p.value.trim()||!e.value))try{v.value=!0;const a=await E().createComment({content:p.value.trim(),post:e.value.id}),r=a.data||a;h.value.unshift(r),p.value="",e.value.comments_count++,g.success("Comentario enviado exitosamente")}catch(o){g.error(o.message||"Error al enviar comentario")}finally{v.value=!1}},V=async()=>{if(e.value)try{const a=await E().getComments({post:e.value.id,page:Math.floor(h.value.length/20)+2});h.value.push(...a.results||a.data||[]),C.value=!!a.next}catch{g.error("Error al cargar más comentarios")}},B=()=>{x.value=!x.value,g.success(x.value?"¡Te gusta este artículo!":"Ya no te gusta este artículo")},D=()=>{const o=`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(window.location.href)}`;window.open(o,"_blank","width=600,height=400")},F=()=>{var r;const o=`${(r=e.value)==null?void 0:r.title} - ${window.location.href}`,a=`https://twitter.com/intent/tweet?text=${encodeURIComponent(o)}`;window.open(a,"_blank","width=600,height=400")},P=async()=>{try{await navigator.clipboard.writeText(window.location.href),g.success("Enlace copiado al portapapeles")}catch{g.error("Error al copiar enlace")}},T=o=>new Date(o).toLocaleDateString("es-ES",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return Y(()=>{e.value&&ot({title:`${e.value.title} - Blog de Noticias`,meta:[{name:"description",content:e.value.meta_description||e.value.excerpt},{property:"og:title",content:e.value.meta_title||e.value.title},{property:"og:description",content:e.value.meta_description||e.value.excerpt},{property:"og:image",content:e.value.image||""},{property:"og:type",content:"article"},{property:"article:author",content:e.value.author.username},{property:"article:published_time",content:e.value.published_at||e.value.created_at}]})}),G(async()=>{try{await S()}catch(o){console.error("Error initializing post page:",o)}}),(o,a)=>{const r=z,u=st,R=nt;return i(),l("div",null,[s(k)?(i(),l("div",ct,a[1]||(a[1]=[J('<div class="max-w-4xl mx-auto" data-v-2a0ce93e><div class="skeleton h-8 w-3/4 mb-4" data-v-2a0ce93e></div><div class="skeleton h-4 w-1/2 mb-8" data-v-2a0ce93e></div><div class="skeleton h-64 mb-8" data-v-2a0ce93e></div><div class="space-y-4" data-v-2a0ce93e><div class="skeleton-text h-4" data-v-2a0ce93e></div><div class="skeleton-text h-4" data-v-2a0ce93e></div><div class="skeleton-text h-4 w-3/4" data-v-2a0ce93e></div></div></div>',1)]))):s(_)?(i(),l("div",dt,[t("div",ut,[d(r,{name:"x",class:"w-12 h-12 text-red-500 mx-auto mb-4"}),a[3]||(a[3]=t("h1",{class:"text-2xl font-bold text-gray-900 dark:text-white mb-2"}," Artículo no encontrado ",-1)),t("p",mt,n(s(_)),1),d(u,{to:"/posts",class:"btn btn-primary"},{default:f(()=>a[2]||(a[2]=[b(" Ver todos los artículos ",-1)])),_:1,__:[2]})])])):s(e)?(i(),l("article",pt,[t("div",gt,[t("header",ht,[t("div",xt,[d(u,{to:`/posts?category=${s(e).category.slug}`,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200 hover:bg-primary-200 dark:hover:bg-primary-800 transition-colors duration-200"},{default:f(()=>[b(n(s(e).category.name),1)]),_:1},8,["to"])]),t("h1",_t,n(s(e).title),1),t("div",vt,[t("div",yt,[t("div",ft,[t("div",bt,n(s(M)(s(e).author)),1),t("div",null,[t("p",wt,n(s(L)(s(e).author)),1),a[4]||(a[4]=t("p",{class:"text-sm"}," Autor ",-1))])]),t("div",kt,[d(r,{name:"calendar",class:"w-4 h-4"}),t("time",{datetime:s(e).published_at||s(e).created_at},n(T(s(e).published_at||s(e).created_at)),9,Ct)]),t("div",Et,[d(r,{name:"clock",class:"w-4 h-4"}),t("span",null,n(s(e).reading_time)+" min de lectura",1)])]),t("div",It,[a[5]||(a[5]=t("span",{class:"text-sm font-medium mr-2"},"Compartir:",-1)),t("button",{class:"p-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition-colors duration-200",title:"Compartir en Facebook",onClick:D},[d(r,{name:"facebook",class:"w-4 h-4"})]),t("button",{class:"p-2 bg-blue-400 text-white rounded-full hover:bg-blue-500 transition-colors duration-200",title:"Compartir en Twitter",onClick:F},[d(r,{name:"twitter",class:"w-4 h-4"})]),t("button",{class:"p-2 bg-gray-600 text-white rounded-full hover:bg-gray-700 transition-colors duration-200",title:"Copiar enlace",onClick:P},[d(r,{name:"share",class:"w-4 h-4"})])])]),s(I)(s(e))?(i(),l("div",Mt,[d(R,{src:s(I)(s(e)),alt:s(e).title,"fallback-src":s(A)("post"),"aspect-ratio":"16/9","image-container-class":"w-full h-64 md:h-96","image-class":"w-full h-full object-cover rounded-lg shadow-lg","lazy-loading":!1,"error-message":"Error al cargar imagen del artículo"},null,8,["src","alt","fallback-src"])])):y("",!0)]),t("div",Lt,[t("div",{innerHTML:s(e).content},null,8,Tt)]),s(e).tags&&s(e).tags.length>0?(i(),l("div",Nt,[a[6]||(a[6]=t("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Tags: ",-1)),t("div",$t,[(i(!0),l(N,null,$(s(e).tags,c=>(i(),at(u,{key:c.id,to:`/posts?tags=${c.slug}`,class:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-primary-100 dark:hover:bg-primary-900 hover:text-primary-700 dark:hover:text-primary-300 transition-colors duration-200"},{default:f(()=>[d(r,{name:"tag",class:"w-3 h-3 mr-1"}),b(" "+n(c.name),1)]),_:2},1032,["to"]))),128))])])):y("",!0),t("div",jt,[t("div",At,[t("button",{class:Q(["flex items-center space-x-2 px-4 py-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors duration-200",{"text-red-500":s(x)}]),onClick:B},[d(r,{name:"heart",class:"w-5 h-5"}),t("span",null,n(s(x)?"Te gusta":"Me gusta"),1)],2)]),t("div",St,n(s(e).comments_count)+" comentarios ",1)]),t("section",Ut,[t("h3",Vt," Comentarios ("+n(s(e).comments_count)+") ",1),s(j)?(i(),l("div",Bt,[t("form",{class:"space-y-4",onSubmit:W(U,["prevent"])},[X(t("textarea",{"onUpdate:modelValue":a[0]||(a[0]=c=>tt(p)?p.value=c:null),placeholder:"Escribe tu comentario...",rows:"4",class:"input resize-none",required:""},null,512),[[Z,s(p)]]),t("div",Dt,[t("button",{type:"submit",disabled:!s(p).trim()||s(v),class:"btn btn-primary"},[s(v)?(i(),l("span",Pt,"Enviando...")):(i(),l("span",Rt,"Enviar comentario"))],8,Ft)])],32)])):(i(),l("div",zt,[a[8]||(a[8]=t("p",{class:"text-gray-600 dark:text-gray-400 mb-4"}," Inicia sesión para dejar un comentario ",-1)),d(u,{to:"/login",class:"btn btn-primary"},{default:f(()=>a[7]||(a[7]=[b(" Iniciar Sesión ",-1)])),_:1,__:[7]})])),t("div",Ht,[(i(!0),l(N,null,$(s(h),c=>(i(),l("div",{key:c.id,class:"bg-gray-50 dark:bg-gray-800 rounded-lg p-6"},[t("div",qt,[t("div",Ot,n(s(M)(c.author)),1),t("div",Kt,[t("div",Yt,[t("h4",Gt,n(s(L)(c.author)),1),t("time",{class:"text-sm text-gray-500 dark:text-gray-400",datetime:c.created_at},n(T(c.created_at)),9,Jt)]),t("p",Qt,n(c.content),1)])])]))),128))]),s(C)?(i(),l("div",Wt,[t("button",{class:"btn btn-secondary",onClick:V}," Cargar más comentarios ")])):y("",!0)])])])):y("",!0)])}}}),oe=rt(Xt,[["__scopeId","data-v-2a0ce93e"]]);export{oe as default};
