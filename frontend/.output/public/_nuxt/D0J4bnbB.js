import{_ as w}from"./D_M7RfL4.js";import{d as x,r as v,J as N,e as L,c as f,a as S,w as k,O as d,h as i,L as y,o as h,f as s,z as b,t as I,i as R,P as z}from"./BE3ND16f.js";const $=["src","alt","loading"],A={class:"error-content"},B={class:"text-xs text-gray-400 mt-1"},M=["aria-label"],V=x({__name:"SafeImage",props:{src:{},alt:{},fallbackSrc:{default:""},aspectRatio:{default:"auto"},containerClass:{default:""},imageContainerClass:{default:""},imageClass:{default:"w-full h-full object-cover"},lazyLoading:{type:Boolean,default:!0},errorMessage:{default:"Error al cargar imagen"},width:{},height:{}},emits:["load","error","click"],setup(u,{emit:c}){const l=u,p=c,e=v(!1),a=v(!1),r=v(l.src),o=t=>{e.value=!1,console.log("âœ… SafeImage loaded:",r.value),p("load",t)},m=t=>{if(console.error("âŒ SafeImage error:",r.value),l.fallbackSrc&&!a.value&&r.value!==l.fallbackSrc){console.log("ðŸ”„ Trying fallback:",l.fallbackSrc),a.value=!0,r.value=l.fallbackSrc;return}e.value=!0,p("error",t)},U=()=>{l.fallbackSrc&&(e.value=!1,a.value=!0,r.value=l.fallbackSrc)};N(()=>l.src,t=>{t!==r.value&&(e.value=!1,a.value=!1,r.value=t)});const g=L(()=>{const t={};return l.aspectRatio&&l.aspectRatio!=="auto"&&(t.aspectRatio=l.aspectRatio),l.width&&(t.width=typeof l.width=="number"?`${l.width}px`:l.width),l.height&&(t.height=typeof l.height=="number"?`${l.height}px`:l.height),t});return(t,n)=>{const C=w;return h(),f("div",{class:y(["safe-image-container",t.containerClass]),style:d(i(g))},[S(C,null,{fallback:k(()=>[s("div",{class:"image-placeholder fallback",style:d(i(g)),role:"img","aria-label":t.alt},n[3]||(n[3]=[s("div",{class:"fallback-content"},[s("svg",{class:"h-8 w-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 002 2z"})]),s("span",{class:"text-xs text-gray-400 mt-1"},"Imagen")],-1)]),12,M)]),default:k(()=>[s("div",{class:"image-wrapper",style:d(i(g))},[!i(e)&&t.src?(h(),f("img",{key:0,src:t.src,alt:t.alt,class:y(t.imageClass),loading:t.lazyLoading?"lazy":"eager",onLoad:o,onError:m,onClick:n[0]||(n[0]=_=>t.$emit("click",_))},null,42,$)):i(e)?(h(),f("div",{key:1,class:"image-placeholder error",style:d(i(g))},[s("div",A,[n[1]||(n[1]=s("svg",{class:"h-8 w-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 002 2z"})],-1)),s("span",B,I(t.errorMessage),1),t.fallbackSrc&&!i(a)?(h(),f("button",{key:0,onClick:U,class:"mt-2 text-xs text-primary-600 hover:text-primary-700 underline"}," Reintentar ")):b("",!0)])],4)):t.src?b("",!0):(h(),f("div",{key:2,class:"image-placeholder no-image",style:d(i(g))},n[2]||(n[2]=[s("div",{class:"fallback-content"},[s("svg",{class:"h-8 w-8 text-gray-300",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 002 2z"})]),s("span",{class:"text-xs text-gray-400 mt-1"},"Sin imagen")],-1)]),4))],4)]),_:1})],6)}}}),E=R(V,[["__scopeId","data-v-bd0ab16f"]]),W=()=>{const u=z(),c=e=>{if(!e)return null;if(console.log("ðŸ–¼ï¸ Normalizing image URL:",e),e.startsWith("http://")||e.startsWith("https://"))return console.log("âœ… Already full URL:",e),e;const a=u.public.apiBase||"http://localhost:8000";console.log("ðŸ”— Base URL:",a);let r=e;if(r.startsWith("/")&&(r=r.substring(1)),r.startsWith("media/")){const m=`${a}/${r}`;return console.log("ðŸ“ Media URL (cleaned):",m),m}const o=`${a}/media/${r}`;return console.log("ðŸ“‚ Added media prefix:",o),o};return{normalizeImageUrl:c,getImageUrl:e=>{const a=e.image_url||e.image||e.imagen;return console.log("ðŸ” Getting image URL for post:",{id:e.id,title:e.title||e.titulo,image_url:e.image_url,image:e.image,imagen:e.imagen,resolved:a}),c(a)},getPlaceholderUrl:(e="post")=>{const a={post:"/images/post-placeholder.svg",avatar:"/images/avatar-placeholder.svg",category:"/images/category-placeholder.svg"};return a[e]||a.post}}},H=()=>{const u=e=>{if(!e)return"U";const a=e.first_name||e.firstName||"",r=e.last_name||e.lastName||"",o=e.username||e.name||"";return a&&r?`${a.charAt(0)}${r.charAt(0)}`.toUpperCase():a?a.charAt(0).toUpperCase():o?o.charAt(0).toUpperCase():"U"},c=e=>{if(!e)return"Usuario";const a=e.first_name||e.firstName||"",r=e.last_name||e.lastName||"",o=e.username||e.name||"",m=e.full_name||e.fullName||"";return m||(a&&r?`${a} ${r}`:a||o||"Usuario")};return{getUserInitials:u,getUserDisplayName:c,getAuthorInitials:e=>u(e),getAuthorDisplayName:e=>c(e)}};export{E as _,W as a,H as u};
