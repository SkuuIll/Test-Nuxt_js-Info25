import{_ as G}from"./CuvBqip4.js";import{_ as L}from"./9ykhWItT.js";import{d as H,r as w,e as f,J as Y,c as i,f as e,z as _,n as q,a as k,v as N,h as a,p as F,G as U,t as y,F as D,k as M,H as j,b as z,g as I,o as u,L as Z,B as J,A as Q,x as K,u as W}from"./BE3ND16f.js";import{u as X}from"./CRYnRe3J.js";import{_ as tt}from"./CmhEpnR6.js";import{u as et}from"./DJaA1xmL.js";import"./DX5PA3XH.js";import"./D0J4bnbB.js";import"./D_M7RfL4.js";import"./CW8f94Lj.js";import"./CxMQz_G8.js";const st={class:"bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-6"},at={class:"mb-6"},ot={class:"relative"},rt={class:"mb-6"},lt={class:"space-y-2 max-h-48 overflow-y-auto"},nt={class:"flex items-center"},it={key:0,class:"ml-auto text-xs text-gray-500"},ut=["value"],dt={class:"ml-2 text-sm text-gray-700 dark:text-gray-300"},ct={class:"ml-auto text-xs text-gray-500"},gt={key:0,class:"mb-6"},pt={class:"flex flex-wrap gap-2"},mt=["onClick"],yt={class:"mb-6"},vt={key:0,class:"mt-3 space-y-2"},xt={class:"mb-6"},bt={key:1,class:"mt-4 pt-4 border-t border-gray-200 dark:border-gray-700"},ft={class:"flex flex-wrap gap-1"},ht={key:0,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200"},kt=H({__name:"CategoryFilter",props:{categories:{},tags:{default:()=>[]},totalPosts:{default:0},initialFilters:{default:()=>({})}},emits:["filter-change"],setup(E,{emit:c}){const n=E,O=c,d=w(n.initialFilters.search||""),o=w(n.initialFilters.category?[n.initialFilters.category]:[]),h=w(n.initialFilters.tags||[]),p=w(""),m=w(""),v=w(""),g=w(n.initialFilters.ordering||"-published_at"),$=f(()=>o.value.map(s=>{var t;return(t=n.categories.find(b=>b.slug===s))==null?void 0:t.name}).filter(Boolean)),P=f(()=>h.value.map(s=>{var t;return(t=n.tags.find(b=>b.slug===s))==null?void 0:t.name}).filter(Boolean)),C=f(()=>d.value||o.value.length>0||h.value.length>0||p.value||g.value!=="-published_at"),S=s=>{const t=h.value.indexOf(s);t>-1?h.value.splice(t,1):h.value.push(s),x()},V=()=>{const s=new Date;switch(p.value){case"today":m.value=s.toISOString().split("T")[0],v.value=s.toISOString().split("T")[0];break;case"week":const t=new Date(s.getTime()-10080*60*1e3);m.value=t.toISOString().split("T")[0],v.value=s.toISOString().split("T")[0];break;case"month":const b=new Date(s.getFullYear(),s.getMonth()-1,s.getDate());m.value=b.toISOString().split("T")[0],v.value=s.toISOString().split("T")[0];break;case"year":const l=new Date(s.getFullYear()-1,s.getMonth(),s.getDate());m.value=l.toISOString().split("T")[0],v.value=s.toISOString().split("T")[0];break;case"":m.value="",v.value="";break}p.value!=="custom"&&x()},x=()=>{const s={search:d.value||void 0,category:o.value.length===1?o.value[0]:void 0,tags:h.value.length>0?h.value:void 0,ordering:g.value,date_from:m.value||void 0,date_to:v.value||void 0};Object.keys(s).forEach(t=>{s[t]===void 0&&delete s[t]}),O("filter-change",s)},T=()=>{d.value="",x()},A=()=>{d.value="",o.value=[],h.value=[],p.value="",m.value="",v.value="",g.value="-published_at",x()},r=X(()=>{x()},500);return Y(o,()=>{x()}),(s,t)=>{const b=L;return u(),i("div",st,[t[19]||(t[19]=e("h3",{class:"text-lg font-semibold text-gray-900 dark:text-white mb-4"}," Filtros ",-1)),e("div",at,[t[8]||(t[8]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Buscar ",-1)),e("div",ot,[q(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>F(d)?d.value=l:null),type:"text",placeholder:"Buscar artículos...",class:"input w-full pl-10",onInput:t[1]||(t[1]=(...l)=>a(r)&&a(r)(...l))},null,544),[[N,a(d)]]),k(b,{name:"search",class:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a(d)?(u(),i("button",{key:0,class:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",onClick:T},[k(b,{name:"x",class:"w-4 h-4"})])):_("",!0)])]),e("div",rt,[t[10]||(t[10]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," Categorías ",-1)),e("div",lt,[e("label",nt,[q(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>F(o)?o.value=l:null),type:"checkbox",value:"",class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,512),[[U,a(o)]]),t[9]||(t[9]=e("span",{class:"ml-2 text-sm text-gray-700 dark:text-gray-300"}," Todas las categorías ",-1)),s.totalPosts?(u(),i("span",it,y(s.totalPosts),1)):_("",!0)]),(u(!0),i(D,null,M(s.categories,l=>(u(),i("label",{key:l.id,class:"flex items-center"},[q(e("input",{"onUpdate:modelValue":t[3]||(t[3]=B=>F(o)?o.value=B:null),type:"checkbox",value:l.slug,class:"rounded border-gray-300 text-primary-600 focus:ring-primary-500"},null,8,ut),[[U,a(o)]]),e("span",dt,y(l.name),1),e("span",ct,y(l.posts_count),1)]))),128))])]),s.tags.length>0?(u(),i("div",gt,[t[11]||(t[11]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-3"}," Etiquetas ",-1)),e("div",pt,[(u(!0),i(D,null,M(s.tags,l=>(u(),i("button",{key:l.id,class:Z(["px-3 py-1 rounded-full text-xs font-medium transition-colors",a(h).includes(l.slug)?"bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200":"bg-gray-100 text-gray-700 hover:bg-gray-200 dark:bg-gray-700 dark:text-gray-300 dark:hover:bg-gray-600"]),onClick:B=>S(l.slug)},y(l.name),11,mt))),128))])])):_("",!0),e("div",yt,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Fecha ",-1)),q(e("select",{"onUpdate:modelValue":t[4]||(t[4]=l=>F(p)?p.value=l:null),class:"input w-full",onChange:V},t[12]||(t[12]=[z('<option value=""> Cualquier fecha </option><option value="today"> Hoy </option><option value="week"> Esta semana </option><option value="month"> Este mes </option><option value="year"> Este año </option><option value="custom"> Rango personalizado </option>',6)]),544),[[j,a(p)]]),a(p)==="custom"?(u(),i("div",vt,[e("div",null,[t[13]||(t[13]=e("label",{class:"block text-xs text-gray-600 dark:text-gray-400 mb-1"}," Desde ",-1)),q(e("input",{"onUpdate:modelValue":t[5]||(t[5]=l=>F(m)?m.value=l:null),type:"date",class:"input w-full",onChange:x},null,544),[[N,a(m)]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block text-xs text-gray-600 dark:text-gray-400 mb-1"}," Hasta ",-1)),q(e("input",{"onUpdate:modelValue":t[6]||(t[6]=l=>F(v)?v.value=l:null),type:"date",class:"input w-full",onChange:x},null,544),[[N,a(v)]])])])):_("",!0)]),e("div",xt,[t[17]||(t[17]=e("label",{class:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2"}," Ordenar por ",-1)),q(e("select",{"onUpdate:modelValue":t[7]||(t[7]=l=>F(g)?g.value=l:null),class:"input w-full",onChange:x},t[16]||(t[16]=[z('<option value="-published_at"> Más recientes </option><option value="published_at"> Más antiguos </option><option value="title"> Título A-Z </option><option value="-title"> Título Z-A </option><option value="-reading_time"> Más largos </option><option value="reading_time"> Más cortos </option>',6)]),544),[[j,a(g)]])]),e("div",{class:"flex space-x-3"},[e("button",{class:"btn btn-primary flex-1",onClick:x}," Aplicar Filtros "),e("button",{class:"btn btn-secondary",onClick:A}," Limpiar ")]),a(C)?(u(),i("div",bt,[e("div",{class:"flex items-center justify-between mb-2"},[t[18]||(t[18]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Filtros activos ",-1)),e("button",{class:"text-xs text-primary-600 hover:text-primary-700",onClick:A}," Limpiar todo ")]),e("div",ft,[a(d)?(u(),i("span",ht,[I(' "'+y(a(d))+'" ',1),e("button",{class:"ml-1 hover:text-primary-600",onClick:T},[k(b,{name:"x",class:"w-3 h-3"})])])):_("",!0),(u(!0),i(D,null,M(a($),l=>(u(),i("span",{key:l,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},y(l),1))),128)),(u(!0),i(D,null,M(a(P),l=>(u(),i("span",{key:l,class:"inline-flex items-center px-2 py-1 rounded text-xs bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"},y(l),1))),128))])])):_("",!0)])}}}),_t={class:"container mx-auto px-4 py-8"},wt={class:"flex flex-col lg:flex-row gap-8"},qt={class:"lg:w-80 flex-shrink-0"},Ft={class:"sticky top-24"},Ct={class:"flex-1"},$t={class:"flex items-center justify-between mb-6"},St={class:"text-3xl font-bold text-gray-900 dark:text-white"},Tt={class:"text-gray-600 dark:text-gray-400 mt-1"},At={key:0,class:"lg:hidden mb-6"},Bt={key:1,class:"mb-6 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg"},Dt={class:"flex flex-wrap gap-2"},Mt={key:0,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-primary-100 text-primary-800 dark:bg-primary-900 dark:text-primary-200"},It={key:1,class:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200"},Gt=H({__name:"index",setup(E){const c=et(),n=J(),O=Q(),d=w(!1),o=w({}),h=f(()=>c.posts),p=f(()=>c.categories),m=f(()=>c.tags||[]),v=f(()=>c.loading),g=f(()=>c.pagination),$=f(()=>{if(o.value.category){const r=p.value.find(s=>s.slug===o.value.category);return`Artículos en ${(r==null?void 0:r.name)||"Categoría"}`}return o.value.query||o.value.search?"Resultados de búsqueda":"Todos los Artículos"}),P=f(()=>Object.keys(o.value).some(r=>o.value[r]!==void 0&&o.value[r]!=="")),C=async r=>{o.value=r,await O.push({path:"/posts",query:r}),r.query||r.search?await c.searchPosts(r):await c.fetchPosts(r),d.value=!1},S=async r=>{const s={...o.value};delete s[r],await C(s)},V=async()=>{await C({})},x=async()=>{o.value.query||o.value.search?await c.searchPosts({...o.value,page:g.value.page+1}):await c.fetchPosts({...o.value,page:g.value.page+1})},T=r=>{var s;return((s=p.value.find(t=>t.slug===r))==null?void 0:s.name)||r},A=()=>{const r={};return n.query.search&&(r.search=n.query.search),n.query.query&&(r.query=n.query.query),n.query.category&&(r.category=n.query.category),n.query.tags&&(r.tags=Array.isArray(n.query.tags)?n.query.tags:[n.query.tags]),n.query.ordering&&(r.ordering=n.query.ordering),n.query.date_from&&(r.date_from=n.query.date_from),n.query.date_to&&(r.date_to=n.query.date_to),r};return K(async()=>{try{await Promise.all([c.fetchCategories()]);const r=A();o.value=r,r.query||r.search?await c.searchPosts(r):await c.fetchPosts(r)}catch(r){console.error("Error initializing posts page:",r)}}),W({title:f(()=>`${$.value} - Blog de Noticias`),meta:[{name:"description",content:f(()=>o.value.query||o.value.search?`Resultados de búsqueda para "${o.value.query||o.value.search}" en nuestro blog de noticias.`:"Explora todos nuestros artículos y noticias. Encuentra contenido relevante y actualizado.")}]}),(r,s)=>{const t=G,b=kt,l=L,B=tt;return u(),i("div",_t,[k(t,{items:[{name:"Artículos"}]}),e("div",wt,[e("aside",qt,[e("div",Ft,[k(b,{categories:a(p),tags:a(m),"total-posts":a(g).total,"initial-filters":a(o),onFilterChange:C},null,8,["categories","tags","total-posts","initial-filters"])])]),e("main",Ct,[e("div",$t,[e("div",null,[e("h1",St,y(a($)),1),e("p",Tt,y(a(g).total)+" artículo"+y(a(g).total!==1?"s":"")+" "+y(a(o).query||a(o).search?`para "${a(o).query||a(o).search}"`:""),1)]),e("button",{class:"lg:hidden btn btn-secondary",onClick:s[0]||(s[0]=R=>d.value=!a(d))},[k(l,{name:"filter",class:"w-4 h-4 mr-2"}),s[3]||(s[3]=I(" Filtros ",-1))])]),a(d)?(u(),i("div",At,[k(b,{categories:a(p),tags:a(m),"total-posts":a(g).total,"initial-filters":a(o),onFilterChange:C},null,8,["categories","tags","total-posts","initial-filters"])])):_("",!0),a(P)?(u(),i("div",Bt,[e("div",{class:"flex items-center justify-between mb-2"},[s[4]||(s[4]=e("span",{class:"text-sm font-medium text-gray-700 dark:text-gray-300"}," Filtros activos: ",-1)),e("button",{class:"text-sm text-primary-600 hover:text-primary-700",onClick:V}," Limpiar todo ")]),e("div",Dt,[a(o).query||a(o).search?(u(),i("span",Mt,[I(' Búsqueda: "'+y(a(o).query||a(o).search)+'" ',1),e("button",{class:"ml-2 hover:text-primary-600",onClick:s[1]||(s[1]=R=>S(a(o).query?"query":"search"))},[k(l,{name:"x",class:"w-3 h-3"})])])):_("",!0),a(o).category?(u(),i("span",It,[I(" Categoría: "+y(T(a(o).category))+" ",1),e("button",{class:"ml-2 hover:text-blue-600",onClick:s[2]||(s[2]=R=>S("category"))},[k(l,{name:"x",class:"w-3 h-3"})])])):_("",!0)])])):_("",!0),k(B,{posts:a(h),loading:a(v),"has-more":a(g).hasNext,"infinite-scroll":!0,"empty-title":"No se encontraron artículos","empty-message":"Intenta ajustar los filtros o buscar otros términos.",onLoadMore:x},null,8,["posts","loading","has-more"])])])])}}});export{Gt as default};
