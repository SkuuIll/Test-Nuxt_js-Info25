import{U as c,T as u,q as d,D as n,V as l}from"./BE3ND16f.js";const h=c(async(s,f)=>{let o,a;try{const e=u(),r=d(),i=r.tokenUtils.getTokens();if(i.access&&!r.tokenUtils.isTokenExpired(i.access)&&e.isAuthenticated){console.log("ðŸ‘¤ User already authenticated, redirecting from guest route");const t=s.query.redirect;return n(t||"/")}if(i.access&&!e.isAuthenticated)try{if([o,a]=l(()=>e.initializeAuth()),await o,a(),e.isAuthenticated){console.log("ðŸ‘¤ User authenticated after initialization, redirecting from guest route");const t=s.query.redirect;return n(t||"/")}}catch(t){console.warn("Auth initialization failed in guest middleware:",t),r.tokenUtils.clearTokens()}}catch(e){console.error("Error in guest middleware:",e)}});export{h as default};
